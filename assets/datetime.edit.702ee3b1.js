import{$ as b,Y as C,l as L,z as c,aV as $,e as n,a5 as l,H as Q,a6 as z,n as P,q as x,j as s,C as m,a9 as M,x as S,k as T,N as _,A as D,b9 as U,_ as B}from"./index.484b954d.js";import{V as E}from"./VDatePicker.1626c1a4.js";import"./VSpacer.f2fd9b54.js";class N{static getDateTimeFormat(){const r=b(),u=C(),f=r.user.preferences.date_time_preferences.date||u.initData.global.date_format||"Y-m-d",d=r.user.preferences.date_time_preferences.time||u.initData.global.time_format||"H:i";return{date:f,time:d}}static getTimeFormatGeneralized(){switch(this.getDateTimeFormat().time){case"H:i":case"H.i":return"24hr";default:return"ampm"}}}const A=L({__name:"datetime.edit",props:{defs:{},label:{},modelValue:{},data:{}},emits:["update:modelValue"],setup(y,{emit:r}){const u=y,f=r,d=c(!1),v=c(!1),a=c(u.modelValue),V=$(),F=n(()=>N.getTimeFormatGeneralized()),p=n({get(){var e;const t=l.fromSQL(a.value);return t.isValid&&t.toFormat(((e=V.user)==null?void 0:e.date_format)||"yyyy-MM-dd")||""},async set(t){var i;d.value=!1,t!=null&&t.trim()||(a.value="");const e=l.fromFormat(t,((i=V.user)==null?void 0:i.date_format)||"yyyy-MM-dd");e.isValid&&(a.value=e.toSQLDate())}}),H=n({get(){const t=l.fromSQL(a.value,{zone:"UTC"});return t.isValid&&t.toLocal().toFormat("HH:mm")||"00:00"},set(t){v.value=!1,t=l.fromSQL(t).setZone("UTC").toFormat("HH:mm");const e=l.fromSQL(a.value,{zone:"UTC"});e.isValid?a.value=`${e.toFormat("yyyy-MM-dd")} ${t}:00`:a.value=""}}),g=n({get(){var t;return(t=a.value)!=null&&t.trim()?new Date(a.value):new Date},set(t){const e=l.fromJSDate(t);if(e.isValid){const i=l.fromSQL(a.value);i.isValid?a.value=`${e.toFormat("yyyy-MM-dd")} ${i.toFormat("HH:mm:ss")}`:a.value=e.toFormat("yyyy-MM-dd HH:mm:ss")}}}),k=n({get(){const t=l.fromSQL(a.value,{zone:"UTC"});return t.isValid&&t.toLocal().toFormat("HH:mm")||"00:00"},set(t){t=l.fromFormat(t,"HH:mm").setZone("UTC").toFormat("HH:mm");const e=l.fromSQL(a.value,{zone:"UTC"});e.isValid?a.value=`${e.toFormat("yyyy-MM-dd")} ${t}:00`:a.value=""}});return Q(a,t=>{d.value=!1,v.value=!1,l.fromSQL(t==null?void 0:t.toString()).isValid?(console.log("new val",a.value),f("update:modelValue",a.value)):(console.log("new val empty"),f("update:modelValue",""))}),(t,e)=>{const i=z("v-time-picker");return P(),x("div",{class:"mint-date-field-detail",onKeyup:[e[6]||(e[6]=U(o=>t.$emit("inlineEditSave"),["enter"])),e[7]||(e[7]=U(o=>t.$emit("inlineEditCancel"),["esc"]))]},[s(D,{label:t.label,variant:"outlined",density:"compact","hide-details":"",modelValue:p.value,"onUpdate:modelValue":e[2]||(e[2]=o=>p.value=o)},{"append-inner":m(()=>[s(M,{modelValue:d.value,"onUpdate:modelValue":e[1]||(e[1]=o=>d.value=o),offset:"16","close-on-content-click":!1},{activator:m(({props:o})=>[s(S,T({class:"mint-date-field-btn"},o),{default:m(()=>e[8]||(e[8]=[_("mdi-calendar")])),_:2},1040)]),default:m(()=>[s(E,{modelValue:g.value,"onUpdate:modelValue":e[0]||(e[0]=o=>g.value=o),"hide-actions":""},{header:m(()=>e[9]||(e[9]=[])),_:1},8,["modelValue"])]),_:1},8,["modelValue"])]),_:1},8,["label","modelValue"]),s(D,{disabled:!p.value,variant:"outlined",density:"compact","hide-details":"",modelValue:H.value,"onUpdate:modelValue":e[5]||(e[5]=o=>H.value=o)},{"append-inner":m(()=>[s(M,{modelValue:v.value,"onUpdate:modelValue":e[4]||(e[4]=o=>v.value=o),offset:"16","close-on-content-click":!1},{activator:m(({props:o})=>[s(S,T({class:"mint-date-field-btn"},o),{default:m(()=>e[10]||(e[10]=[_("mdi-clock-time-eight-outline")])),_:2},1040)]),default:m(()=>[s(i,{modelValue:k.value,"onUpdate:modelValue":e[3]||(e[3]=o=>k.value=o),format:F.value,"ampm-in-title":F.value==="ampm"},{header:m(()=>e[11]||(e[11]=[])),_:1},8,["modelValue","format","ampm-in-title"])]),_:1},8,["modelValue"])]),_:1},8,["disabled","modelValue"])],32)}}});const Y=B(A,[["__scopeId","data-v-746e3376"]]);export{Y as default};
